{"version":3,"sources":["TCS-157.js"],"names":["Drupal","$","behaviors","flyingCTA","attach","context","settings","latestKnownScrollY","ticking","$cta","first","once","$fixed","isFixed","animatingOut","update","boundingClientRect","$clone","getBoundingClientRect","shouldBeFixed","top","isMobile","window","innerWidth","clone","css","append","addClass","appendTo","position","right","bottom","left","fixedBoundingClientRect","getFixedBoundingClientRect","diffX","diffY","setTimeout","removeClass","scrollY","transform","one","addEventListener","onScroll","length","requestAnimationFrame","jQuery"],"mappings":";CAKA,SAAWA,EAAQC,GACjB,aAEAD,EAAOE,UAAUC,UAAY,CAC3BC,OAAQ,SAAUC,EAASC,GACrBC,IACAC,GAAU,EACVC,EAAOR,EAAE,uEAAuES,QAAQC,KAAK,cAC7FC,EAAS,KACTC,GAAU,EAEVC,GAAe,EAEVC,SAAAA,IAGPP,GAAU,EAENQ,IAyEAC,EAzEAD,EAAqBP,EAAK,GAAGS,wBAC7BC,EAAgBH,EAAmBI,IAAM,GACzCC,EAAWC,OAAOC,WAAa,IAQ/B,GALAJ,IAAkBP,IAoElBK,EAASR,EACVe,QACEC,IAAI,CACYhB,cAAAA,EAAKgB,IAAI,eACPhB,gBAAAA,EAAKgB,IAAI,iBACRhB,iBAAAA,EAAKgB,IAAI,kBACXhB,eAAAA,EAAKgB,IAAI,kBAG/BhB,EAAKgB,IAAI,aAAc,QACvBhB,EAAKgB,IAAI,aAAc,UAEvBb,EAASX,EAAE,SACRyB,OAAOT,GACPU,SAAS,OACTC,SAAS3B,EAAE,WA9ETY,GAAWM,EAAe,CAE7BP,EACGa,IAAI,CACHI,SAAU,QACVT,IAAKC,EAAW,OAAS,MACzBS,MAAOT,EAAW,OAAS,OAC3BU,OAAQV,EAAW,IAAM,OACzBW,KAAMX,EAAW,EAAI,SAGrBY,IAAAA,EAA0BC,IAC1BC,EAAQnB,EAAmBgB,KAAOC,EAAwBD,KAC1DI,EAAQpB,EAAmBI,IAAMa,EAAwBb,IAC7DR,EAAOa,IAAI,YAAa,cAAgBU,EAAQ,kBAAoBC,EAAQ,OAE5EvB,GAAU,EAEVwB,WAAW,WACTzB,EACGa,IAAI,YAAa,IACjBE,SAAS,aAIX,GAAGd,IAAYM,IAAkBL,EAAc,CAC9CmB,EAA0BC,IAC9BpB,GAAe,EAEfF,EACG0B,YAAY,MACZb,IAAI,CACHI,SAAU,WACVT,IAAKJ,EAAmBI,IAAME,OAAOiB,QACrCT,MAAO,OACPE,KAAMhB,EAAmBgB,KACzBQ,UAAW,eAAiBP,EAAwBD,KAAOhB,EAAmBgB,MAAQ,mBAAqBC,EAAwBb,IAAMJ,EAAmBI,KAAO,QAGvKiB,WAAW,WACTzB,EACGa,IAAI,YAAa,IACjBE,SAAS,OAEZf,EAAO6B,IAAI,gBAAiB,WAC1B5B,GAAU,EACVC,GAAe,EACfE,EAAqBP,EAAK,GAAGS,wBAE7BN,EACG0B,YAAY,OACZb,IAAI,CACHI,SAAU,WACVT,IAAKJ,EAAmBI,IAAME,OAAOiB,QAAU,KAC/CT,MAAO,OACPE,KAAMhB,EAAmBgB,KAAO,YA0BnCE,SAAAA,IACAtB,OAAAA,EAAO,GAAGM,wBAenBI,OAAOoB,iBAAiB,SAZfC,WACcrB,OAAOiB,SAKvB/B,GAAWC,EAAKmC,OAAS,GAC5BtB,OAAOuB,sBAAsB9B,GAE/BP,GAAU,IAGgC,KA7HlD,CAiIGR,OAAQ8C","file":"TCS-157.map","sourceRoot":"..\\src\\js","sourcesContent":["/**\n * @file\n * Global scripts, loaded on every page.\n */\n\n(function (Drupal, $) {\n  'use strict';\n\n  Drupal.behaviors.flyingCTA = {\n    attach: function (context, settings) {\n      var latestKnownScrollY = 0;\n      var ticking = false;\n      var $cta = $('.paragraph--type--header .field--name-parade-call-to-action .button').first().once('flying-cta');\n      var $fixed = null;\n      var isFixed = false;\n      var classAfterScroll = 'fly';\n      var animatingOut = false;\n\n      function update() {\n        // reset the tick so we can\n        // capture the next onScroll\n        ticking = false;\n\n        var boundingClientRect = $cta[0].getBoundingClientRect();\n        var shouldBeFixed = boundingClientRect.top < 50;\n        var isMobile = window.innerWidth < 768;\n\n        // Create fixed element if it hasnt been created yet.\n        if (shouldBeFixed && !$fixed) {\n          createFixed();\n        }\n\n        // Fix it.\n        if (!isFixed && shouldBeFixed) {\n          // Move button in the place of the original, so we can animate it from there.\n          $fixed\n            .css({\n              position: 'fixed',\n              top: isMobile ? 'auto' : '50%',\n              right: isMobile ? 'auto' : '20px',\n              bottom: isMobile ? '0' : 'auto',\n              left: isMobile ? 0 : 'auto',\n            });\n\n          var fixedBoundingClientRect = getFixedBoundingClientRect();\n          var diffX = boundingClientRect.left - fixedBoundingClientRect.left;\n          var diffY = boundingClientRect.top - fixedBoundingClientRect.top;\n          $fixed.css('transform', 'translateX(' + diffX + 'px) translateY(' + diffY + 'px)');\n\n          isFixed = true;\n\n          setTimeout(function() {\n            $fixed\n              .css('transform', '')\n              .addClass('in')\n          });\n        }\n        // Go back to normal.\n        else if(isFixed && !shouldBeFixed && !animatingOut) {\n          var fixedBoundingClientRect = getFixedBoundingClientRect();\n          animatingOut = true;\n\n          $fixed\n            .removeClass('in')\n            .css({\n              position: 'absolute',\n              top: boundingClientRect.top + window.scrollY,\n              right: 'auto',\n              left: boundingClientRect.left,\n              transform: 'translateX(' + (fixedBoundingClientRect.left - boundingClientRect.left) + 'px) translateY(' + (fixedBoundingClientRect.top - boundingClientRect.top) + 'px)'\n            })\n\n          setTimeout(function() {\n            $fixed\n              .css('transform', '')\n              .addClass('out');\n\n            $fixed.one('transitionend', function() {\n              isFixed = false;\n              animatingOut = false;\n              boundingClientRect = $cta[0].getBoundingClientRect();\n\n              $fixed\n                .removeClass('out')\n                .css({\n                  position: 'absolute',\n                  top: boundingClientRect.top + window.scrollY + 'px',\n                  right: 'auto',\n                  left: boundingClientRect.left + 'px',\n                });\n            })\n          });\n        }\n      }\n\n      function createFixed() {\n        var $clone = $cta\n          .clone()\n            .css({\n              'padding-top': $cta.css('padding-top'),\n              'padding-right': $cta.css('padding-right'),\n              'padding-bottom': $cta.css('padding-bottom'),\n              'padding-left': $cta.css('padding-left'),\n            })\n\n        $cta.css('transition', 'none');\n        $cta.css('visibility', 'hidden');\n\n        $fixed = $('<div>')\n          .append($clone)\n          .addClass('fly')\n          .appendTo($('body'));\n      }\n\n      function getFixedBoundingClientRect() {\n        return $fixed[0].getBoundingClientRect();\n      }\n\n      function onScroll() {\n        latestKnownScrollY = window.scrollY; //No IE8\n        requestTick();\n      }\n\n      function requestTick() {\n        if (!ticking && $cta.length > 0) {\n          window.requestAnimationFrame(update);\n        }\n        ticking = true;\n      }\n\n      window.addEventListener('scroll', onScroll, false);\n    }\n  };\n\n})(Drupal, jQuery);\n"]}